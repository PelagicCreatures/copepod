{"version":3,"file":"copepod.iife.js","sources":["../lib/Copepod.js","../index.js"],"sourcesContent":["import {\n\tutils\n}\n\tfrom '@pelagiccreatures/sargasso'\n\nlet unique = 0\n\n// build Proxy to handle set and delete on an object's properties\nconst buildProxy = (thisContext) => {\n\treturn {\n\t\tset (target, property, value) {\n\t\t\tReflect.set(target, property, value)\n\t\t\tthisContext.notify(property)\n\t\t\treturn true\n\t\t},\n\t\tdeleteProperty (target, property) {\n\t\t\tReflect.deleteProperty(target, property)\n\t\t\tthisContext.notify(property)\n\t\t\treturn true\n\t\t}\n\t}\n}\n\nclass Copepod {\n\tconstructor (obj) {\n\t\tthis.uid = ++unique\n\n\t\tthis.inputs = {} // inputs to watch for value changes\n\t\tthis.subscribers = {} // watchers to notify on value change\n\n\t\tthis.obj = new Proxy(obj, buildProxy(this))\n\t}\n\n\tdestroy () {\n\t\t// cleanup event handlers\n\t\tObject.keys(this.inputs).forEach((k) => {\n\t\t\tutils.elementTools.off(this.constructor.name + '-' + this.uid, this.inputs[k], 'keyup change click')\n\t\t})\n\t}\n\n\tset (property, value) {\n\t\tthis.obj[property] = value\n\t}\n\n\tdeleteProperty (property) {\n\t\tdelete this.obj[property]\n\t}\n\n\tattachInput (input) {\n\t\tconst inputProp = input.getAttribute('name')\n\t\tthis.inputs[inputProp] = input\n\n\t\t// if input has a value, initialize this.obj[property] to input value\n\t\tif (input.value && input.value !== this.obj[inputProp]) {\n\t\t\tthis.obj[inputProp] = input.value\n\t\t} else {\n\t\t\tthis.obj[inputProp] = ''\n\t\t}\n\n\t\t// keep property in sync with input\n\t\tutils.elementTools.on(this.constructor.name + '-' + this.uid, input, 'keyup change click', '', (e) => {\n\t\t\tif (e.target.value !== this.obj[inputProp]) {\n\t\t\t\tthis.obj[inputProp] = e.target.value\n\t\t\t}\n\t\t}, true)\n\t}\n\n\tdetatchInput (input) {\n\t\tconst inputProp = input.getAttribute('name')\n\t\tutils.elementTools.off(this.constructor.name + '-' + this.uid, input, 'keyup change click', '')\n\t\tdelete this.inputs[inputProp]\n\t}\n\n\tsubscribe (id, fn) {\n\t\tthis.subscribers[id] = fn\n\t\tObject.keys(this.obj).forEach((k) => {\n\t\t\tfn(k, this.obj[k])\n\t\t})\n\t}\n\n\tunSubscribe (id) {\n\t\tif (this.subscribers[id]) {\n\t\t\tdelete this.subscribers[id]\n\t\t}\n\t}\n\n\tnotify (property) {\n\t\t// sync inputs (input <- this.obj[property])\n\t\tObject.keys(this.inputs).forEach((k) => {\n\t\t\tthis.inputs[k].value = this.obj[k].toString()\n\t\t})\n\n\t\t// tell subscribers\n\t\tObject.keys(this.subscribers).forEach((k) => {\n\t\t\tthis.subscribers[k](property, this.obj[property])\n\t\t})\n\t}\n}\n\nexport {\n\tCopepod\n}\n","/**\n\t@PelagicCreatures/Copepod\n\n\tSargasso class that impelments lazy loaded images using background-image which always\n\tfits image within its container's dimensions\n\n\t@author Michael Rhodes\n\t@license MIT\n\tMade in Barbados ðŸ‡§ðŸ‡§ Copyright Â© 2020 Michael Rhodes\n\n**/\n\nimport {\n\tCopepod\n}\n\tfrom './lib/Copepod.js'\n\nexport {\n\tCopepod\n}\n"],"names":["utils"],"mappings":";;;;CAKA,IAAI,MAAM,GAAG,EAAC;AACd;CACA;CACA,MAAM,UAAU,GAAG,CAAC,WAAW,KAAK;CACpC,CAAC,OAAO;CACR,EAAE,GAAG,CAAC,CAAC,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE;CAChC,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAC;CACvC,GAAG,WAAW,CAAC,MAAM,CAAC,QAAQ,EAAC;CAC/B,GAAG,OAAO,IAAI;CACd,GAAG;CACH,EAAE,cAAc,CAAC,CAAC,MAAM,EAAE,QAAQ,EAAE;CACpC,GAAG,OAAO,CAAC,cAAc,CAAC,MAAM,EAAE,QAAQ,EAAC;CAC3C,GAAG,WAAW,CAAC,MAAM,CAAC,QAAQ,EAAC;CAC/B,GAAG,OAAO,IAAI;CACd,GAAG;CACH,EAAE;CACF,EAAC;AACD;CACA,MAAM,OAAO,CAAC;CACd,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE;CACnB,EAAE,IAAI,CAAC,GAAG,GAAG,EAAE,OAAM;AACrB;CACA,EAAE,IAAI,CAAC,MAAM,GAAG,GAAE;CAClB,EAAE,IAAI,CAAC,WAAW,GAAG,GAAE;AACvB;CACA,EAAE,IAAI,CAAC,GAAG,GAAG,IAAI,KAAK,CAAC,GAAG,EAAE,UAAU,CAAC,IAAI,CAAC,EAAC;CAC7C,EAAE;AACF;CACA,CAAC,OAAO,CAAC,GAAG;CACZ;CACA,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK;CAC1C,GAAGA,cAAK,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,oBAAoB,EAAC;CACvG,GAAG,EAAC;CACJ,EAAE;AACF;CACA,CAAC,GAAG,CAAC,CAAC,QAAQ,EAAE,KAAK,EAAE;CACvB,EAAE,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,MAAK;CAC5B,EAAE;AACF;CACA,CAAC,cAAc,CAAC,CAAC,QAAQ,EAAE;CAC3B,EAAE,OAAO,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAC;CAC3B,EAAE;AACF;CACA,CAAC,WAAW,CAAC,CAAC,KAAK,EAAE;CACrB,EAAE,MAAM,SAAS,GAAG,KAAK,CAAC,YAAY,CAAC,MAAM,EAAC;CAC9C,EAAE,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,MAAK;AAChC;CACA;CACA,EAAE,IAAI,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,KAAK,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;CAC1D,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,GAAG,KAAK,CAAC,MAAK;CACpC,GAAG,MAAM;CACT,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,GAAG,GAAE;CAC3B,GAAG;AACH;CACA;CACA,EAAEA,cAAK,CAAC,YAAY,CAAC,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE,oBAAoB,EAAE,EAAE,EAAE,CAAC,CAAC,KAAK;CACxG,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,KAAK,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;CAC/C,IAAI,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,MAAK;CACxC,IAAI;CACJ,GAAG,EAAE,IAAI,EAAC;CACV,EAAE;AACF;CACA,CAAC,YAAY,CAAC,CAAC,KAAK,EAAE;CACtB,EAAE,MAAM,SAAS,GAAG,KAAK,CAAC,YAAY,CAAC,MAAM,EAAC;CAC9C,EAAEA,cAAK,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE,oBAAoB,EAAE,EAAE,EAAC;CACjG,EAAE,OAAO,IAAI,CAAC,MAAM,CAAC,SAAS,EAAC;CAC/B,EAAE;AACF;CACA,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE;CACpB,EAAE,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,GAAG,GAAE;CAC3B,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK;CACvC,GAAG,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAC;CACrB,GAAG,EAAC;CACJ,EAAE;AACF;CACA,CAAC,WAAW,CAAC,CAAC,EAAE,EAAE;CAClB,EAAE,IAAI,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE;CAC5B,GAAG,OAAO,IAAI,CAAC,WAAW,CAAC,EAAE,EAAC;CAC9B,GAAG;CACH,EAAE;AACF;CACA,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE;CACnB;CACA,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK;CAC1C,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAE;CAChD,GAAG,EAAC;AACJ;CACA;CACA,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK;CAC/C,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAC;CACpD,GAAG,EAAC;CACJ,EAAE;CACF;;CCjGA;CACA;AACA;CACA;CACA;AACA;CACA;CACA;CACA;AACA;CACA,GAAG;;;;;;;;;;"}