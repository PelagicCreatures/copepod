{"version":3,"file":"copepod.iife.js","sources":["../lib/Copepod.js","../index.js"],"sourcesContent":["import {\n\tutils\n}\n\tfrom '@pelagiccreatures/sargasso'\n\nlet unique = 0\n\n/*\n\t<input name=\"itsalive\">\n\n\tlet myObj = {itsalive:'initial value'}\n\tlet live = new Copepod(myObj,document.querySelector('[name=\"itsalive\"]'))\n\n\tlive.subscribe('uuid',(val) => {\n\t\tconsole.log('changed to ',val)\n\t})\n\n\tlive.itsalive = 100 // will set input to 100 and notify any subscribers\n*/\n\nconst buildProxy = (thisContext) => {\n\treturn {\n\t\tset (target, property, value) {\n\t\t\tReflect.set(target, property, value)\n\t\t\tthisContext.notify()\n\t\t\tif (thisContext.watch) {\n\t\t\t\tthisContext.watch.value = thisContext.value[thisContext.inputProp].toString()\n\t\t\t}\n\t\t\treturn true\n\t\t},\n\t\tdeleteProperty (target, property) {\n\t\t\tReflect.deleteProperty(target, property)\n\t\t\tthisContext.notify()\n\t\t\treturn true\n\t\t}\n\t}\n}\n\nclass Copepod {\n\tconstructor (obj, watchInputForChange) {\n\t\tthis.uid = ++unique\n\t\tthis.subscribers = {}\n\t\tthis.value = obj\n\n\t\tif (watchInputForChange) {\n\t\t\tthis.watch = watchInputForChange\n\t\t\tthis.inputProp = this.watch.getAttribute('name')\n\t\t\tif (!obj[this.inputProp]) {\n\t\t\t\tobj[this.inputProp] = ''\n\t\t\t}\n\t\t\tif (this.watch.value && this.watch.value !== obj[this.inputProp]) {\n\t\t\t\tobj[this.inputProp] = this.watch.value\n\t\t\t}\n\t\t\tutils.elementTools.on(this.constructor.name + '-' + this.uid, this.watch, 'keyup change click', '', (e) => {\n\t\t\t\tif (this.watch.value !== this.value[this.inputProp]) {\n\t\t\t\t\tthis.value[this.inputProp] = this.watch.value\n\t\t\t\t}\n\t\t\t}, true)\n\t\t}\n\n\t\tthis.value = new Proxy(obj, buildProxy(this))\n\t}\n\n\tdestroy () {\n\t\tif (this.watch) {\n\t\t\tutils.elementTools.off(this.constructor.name + '-' + this.uid, this.watch, 'keyup change click')\n\t\t}\n\t}\n\n\tsubscribe (id, fn) {\n\t\tthis.subscribers[id] = fn\n\t\tfn(this.value)\n\t}\n\n\tunSubscribe (id) {\n\t\tif (this.subscribers[id]) {\n\t\t\tdelete this.subscribers[id]\n\t\t}\n\t}\n\n\tnotify () {\n\t\tObject.keys(this.subscribers).forEach((k) => {\n\t\t\tthis.subscribers[k](this.value)\n\t\t})\n\t}\n}\n\nexport {\n\tCopepod\n}\n","/**\n\t@PelagicCreatures/Copepod\n\n\tSargasso class that impelments lazy loaded images using background-image which always\n\tfits image within its container's dimensions\n\n\t@author Michael Rhodes\n\t@license MIT\n\tMade in Barbados ðŸ‡§ðŸ‡§ Copyright Â© 2020 Michael Rhodes\n\n**/\n\nimport {\n\tCopepod\n}\n\tfrom './lib/Copepod.js'\n\nexport {\n\tCopepod\n}\n"],"names":["utils"],"mappings":"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"}